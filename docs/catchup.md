# Catchup 插件

## 版本历史

- **v1.1** - 使用 sao_nkr 发癫文案替换模板（单人16条 + 双人15条）
- **v1.0** - 初始版本，多关键词支持、独立频率限制

## 功能介绍

Catchup 是一个基于 PagerMaid-Pyro 的关键词触发回复插件，支持多关键词配置、独立频率限制和灵活的目标回复。

**模板来源：** 使用 sao_nkr 插件的发癫风格文案，包含单人独白和双人互动两种模式。

## 主要特性

- **多关键词配置** - 支持为不同关键词设置不同的目标用户和群组
- **自定义触发词** - 通过 `/关键词` 格式触发回复
- **独立频率限制** - 每个关键词单独计算频率限制时间
- **主人特权** - 主人触发不受任何频率限制
- **共享模板池** - 所有关键词使用统一的回复模板池

## 使用方法

### 配置插件

1. **设置关键词配置**：
   ```
   ,catchup set <关键词> <用户ID> <群组ID> [秒数]
   ```

2. **设置主人ID**（可选）：
   ```
   ,catchup owner <你的Telegram用户ID>
   ```

3. **开启功能**：
   ```
   ,catchup on
   ```

4. **查看状态**：
   ```
   ,catchup status
   ```

### 触发方式

在群组中发送 `/关键词`，例如：
- `/hello` - 触发 hello 关键词配置
- `/hi` - 触发 hi 关键词配置

### 管理命令

| 命令 | 说明 |
|------|------|
| `,catchup on` | 开启全局功能 |
| `,catchup off` | 关闭全局功能 |
| `,catchup set <关键词> <用户ID> <群组ID> [秒数]` | 添加/更新关键词配置 |
| `,catchup delete <关键词>` | 删除关键词配置 |
| `,catchup list` | 列出所有关键词配置 |
| `,catchup owner <用户ID>` | 设置主人ID |
| `,catchup status` | 查看当前状态 |

## 文件结构

```
plugins/
├── catchup.py                   # 插件主文件
├── catchup_config.json          # 配置文件（自动生成）
└── catchup_trigger_log.json     # 触发记录（自动生成）
```

## 技术实现

### 核心技术点

- 使用 `listener` 监听群组消息
- 支持关键词匹配触发命令
- 每个关键词独立频率限制
- 配置数据持久化存储为 JSON

### 数据结构

#### catchup_config.json
```json
{
  "enabled": true,
  "owner_id": 123456789,
  "keywords": {
    "hello": {
      "target_user_id": 987654321,
      "target_chat_id": -1001234567890,
      "rate_limit_seconds": 3600
    }
  }
}
```

## 注意事项

1. 主人ID为可选配置，不设置时所有人都受频率限制
2. 回复会回复目标用户的最近发言
3. 确保在正确的群组中使用触发命令
4. 触发命令的消息会在发送后被自动删除
